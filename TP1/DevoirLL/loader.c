#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "types.h"


int loader(int debut, module mod, instr *mem) {
  int pos = debut;
    union value empty;
  for(int i = 0;i<mod.size;i++){
      instr instr1=mod.listeinstr[i];

      if(strcmp(instr1.def,"deb")==0) {
          union value val;
          val.n=i+debut+1;
          mem[debut] = newinstr("", "call", 1, 2, 0,val,0,0,empty);
      }
      for(int n=0;n<instr1.nbarg;n++){
          if (instr1.args[n].type==3 && instr1.args[n].intorname==0){ // && intorstring = 1
              instr1.args[n].type=2;
              if(instr1.args[n].val.n!=-1)
              instr1.args[n].val.n+=debut+1;
          }
      }
      mem[i+debut+1]=instr1;
  }
  return pos;
}
