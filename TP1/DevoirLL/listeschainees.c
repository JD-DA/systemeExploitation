#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "listeschainees.h"

List *init()
{
    List *list = malloc(sizeof(*list));
    Element *element = malloc(sizeof(*element));

    if (list == NULL || element == NULL)
    {
        exit(EXIT_FAILURE);
    }

    list->first = NULL;

    return list;
}


void inser(List *list, char *name, int adr)
{
  Element *new = malloc(sizeof(*new));
  if (list == NULL || new == NULL)
    {
      exit(EXIT_FAILURE);
    }
  new->name = name;
  new->adr = adr;
  
  new->next = list->first;
  list->first = new;
}

void ajoutReference(List *list, char *name)
{
    Element *elem = list->first;

        while (elem != NULL) {
            if(strcmp(elem->name,name)==0)
                return;
            elem = elem->next;
        }
        inser(list,name,-1);


}
void ajoutDefinition(List *list, char *name, int adr)
{
            Element *elem = list->first;

        while (elem != NULL) {
            if(strcmp(elem->name,name)==0) {
                if (elem->adr == -1) {
                    elem->adr = adr;
                    return;
                } else {
                    return;
                }
            }
            elem = elem->next;
        }
        inser(list,name,adr);

}

int checkRef(List *list, char *name)
{
    Element *elem = list->first;

    while (elem != NULL) {
        if(strcmp(elem->name,name)==0) {
            return elem->adr;
        }
        elem = elem->next;
    }
    exit(EXIT_FAILURE);

}


void printlist(List *list)
{
  if (list == NULL)
    {
      exit(EXIT_FAILURE);
    }

    Element *elem = list->first;

    while (elem != NULL)
      {
	printf(elem->name);
        printf(",%d -> ", elem->adr);
        elem = elem->next;
    }
    printf("NULL\n");
}


